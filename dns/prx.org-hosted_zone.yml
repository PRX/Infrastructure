# dns/prx.org-hosted_zone.yml
AWSTemplateFormatVersion: "2010-09-09"
Description: Hosted zone and record sets for prx.org

Parameters:
  Domain:
    Default: prx.org.
    Description: The domain name and hosted zone
    Type: String

Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      HostedZoneConfig:
        Comment: prx.org
      HostedZoneTags:
        - { Key: prx:meta:tagging-version, Value: "2021-04-07" }
        - { Key: prx:cloudformation:stack-name, Value: !Ref AWS::StackName }
        - { Key: prx:cloudformation:stack-id, Value: !Ref AWS::StackId }
        - { Key: prx:ops:environment, Value: Production }
        - { Key: prx:dev:application, Value: Common }
      Name: !Ref Domain

  # Purpose-based
  Text:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      # Route53 expects TXT record values to be enclosed in double quotes, so in
      # the YAML they need to be double-quoted.
      # Each domain name should only have a single text record. Add multiple
      # resource records if necessary.
      # All SPF records need to go into a single resource record.
      Comment: TXT Records
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Ref Domain
          ResourceRecords:
            # SPF
            - '"v=spf1 include:_spf.google.com include:_spf.createsend.com include:amazonses.com include:mail.zendesk.com include:_spf.salesforce.com -all"'
            # Domain verification
            - '"amazon-business-verification=ad3856864cdfe75089169fd3d7be80c0bbfa6773e6a80757d107a98de027534b"'
            - '"apple-domain-verification=nd7ZcKMYeWFpLWd1"'
            - '"atlassian-domain-verification=0qLmYvyPRQa/uMaLKELb6Gb81mdCG09UaOQa2alPjlZpFl6W1LHIFqQZA5WXDfq/"'
            - '"google-site-verification=j5qsGbnU-E37T9lsaAYL1967H0ej6iZAeX_vEWcOA-w"'
            - '"google-site-verification=NgVnyJeUZ7gbeAr4l2BeDMfDonC-U6W2VONkOMxb4IM"'
            - '"google-site-verification=j6DW4DZxyKz5eX_UEMJ2zft2FcZquM6DLZCYzKkOeSs"'
            - '"google-site-verification=Znp586glw_kMRjBH8f1m21zuKyuBwOPgOVSDRtLgYHw"'
            - '"status-page-domain-verification=6n18jv5h9b5d"'
            - '"1password-site-verification=BN63T7MKAZD7FDVOOQIPM4Z4ZQ"'
            - '"f4tg44j88n3rnv8r8t7ecnih09"' # GoDaddy
            - '"ZOOM_verify_hkRIXqykzCF2JyIf6sPKov"' # Zoom
            # Other
            - '"MS=ms48604406"'
          TTL: "300"
          Type: TXT
        - Name: !Sub notifications.${Domain}
          ResourceRecords:
            - '"v=spf1 include:stspg-customer.com ~all"'
          TTL: "300"
          Type: TXT
  Calendars:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Calendars
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub calendar.${Domain}
          ResourceRecords:
            - ghs.googlehosted.com.
          TTL: "300"
          Type: CNAME
  Email:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Email
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # Webmail
        - Name: !Sub mail.${Domain}
          ResourceRecords:
            - ghs.googlehosted.com.
          TTL: "3600"
          Type: CNAME

        # Inbound email for @prx.org, currently through Google Workspace
        - Name: !Ref Domain
          ResourceRecords:
            - 1 ASPMX.L.GOOGLE.COM.
            - 5 ALT1.ASPMX.L.GOOGLE.COM.
            - 5 ALT2.ASPMX.L.GOOGLE.COM.
            - 10 ASPMX2.GOOGLEMAIL.COM.
            - 10 ASPMX3.GOOGLEMAIL.COM.
          TTL: "3600"
          Type: MX

        # DMARC
        # https://simonandrews.ca/articles/how-to-set-up-spf-dkim-dmarc#dmarc
        # Sets the DMARC policy for email sent from @prx.org
        - Name: !Sub _dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1; p=reject; pct=100; rua=mailto:dmarc-reports@prx.org,mailto:dmarc@qf66rrn4.uriports.com; ruf=mailto:dmarc-reports@prx.org,mailto:dmarc@qf66rrn4.uriports.com"'
          TTL: "300"
          Type: TXT

        # This allows DMARC reports from radiotopia.fm to be sent to a prx.org
        # address
        - Name: !Sub radiotopia.fm._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from theworld.org to be sent to a prx.org
        # address
        - Name: !Sub theworld.org._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from trax.fm to be sent to a prx.org
        # address
        - Name: !Sub trax.fm._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from earhustlesq.com to be sent to a prx.org
        # address
        - Name: !Sub earhustlesq.com._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from podcastgarage.org to be sent to a
        # prx.org address
        - Name: !Sub podcastgarage.org._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from passengerlist.org to be sent to a
        # prx.org address
        - Name: !Sub passengerlist.org._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT
        # This allows DMARC reports from pri.org to be sent to a
        # prx.org address
        - Name: !Sub pri.org._report._dmarc.${Domain}
          ResourceRecords:
            - '"v=DMARC1"'
          TTL: "172800"
          Type: TXT

        # DKIM
        - Name: !Sub smtp._domainkey.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDhbR6vE/h4/KEg6lvClOh1PhgDM83LC90coBFLeDhrp5O92VOViTmHbckO+L9fZCvJzIY8ZM1xbY+o1Rlh0ap7afOze2oIdFZC9yaG3Vs3prl0vI2sbLISZqb3pYG9q33Sy3yavI8Hc0LUbYtnSwlzANhgggDX9EMDWjvDE97B3QIDAQAB"'
          TTL: "300"
          Type: TXT
        - Name: !Sub m1._domainkey.notifications.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; t=s; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCUsMXVyvoTUJ3Ov/NAsONt5pXDjUfIJF8h4gZ4qcswAdOXZ8BBqGfLz5uq8PWXdfwZTP8k4aPiqgm8MuGNYXa2Hk974OtgXJSMkJ4XToZHhIXJTxcTO2dpcdn71PBuc4hotsfOGmMP6js3iT2tIppDv+3omcJ/bpb+NoRxpjOuwIDAQAB"'
          TTL: "300"
          Type: TXT
        - Name: !Sub smtp._domainkey.notifications.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDGmpjXCnmmwNbMer0teWRN35zZWg6eF+ZhDIBdQtZH46rP8m5G0PylQ7McHLaPOST1V3Ze3tshxU/uuJde9rOyhZxuh+Tp+CkvF+pZYv//84K5Ev4UdWWklaoPS4KnCQyeTNQZdnXOoiMfMtR2Vs4tLV34ngqbCtBLJc9Sz9408QIDAQAB"'
          TTL: "300"
          Type: TXT
  Podcasts:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Feedburner
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub feeds.${Domain}
          ResourceRecords:
            - io25k.feedproxy.ghs.google.com.
          TTL: "300"
          Type: CNAME
  TheMoth:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: The Moth
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub cdn1.themoth.${Domain}
          ResourceRecords:
            - pc-a.bitgravity.com.
          TTL: "3600"
          Type: CNAME
  Web:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: HowSound
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # 2021.prx.org
        - Name: !Sub 2021.${Domain}
          ResourceRecords:
            - prx.github.io.
          TTL: "300"
          Type: CNAME
        # 2023.prx.org
        - Name: !Sub 2023.${Domain}
          ResourceRecords:
            - prx.github.io.
          TTL: "300"
          Type: CNAME
        # blog.prx.org
        - AliasTarget:
            DNSName: d1uuj4xcfminz6.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub blog.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d1uuj4xcfminz6.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub blog.${Domain}
          Type: AAAA
        # catapult.prx.org
        - AliasTarget:
            DNSName: d584ne29dh50y.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub catapult.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d584ne29dh50y.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub catapult.${Domain}
          Type: AAAA
        # # dovetail.prx.org
        - AliasTarget:
            DNSName: d8u55dsm5y1tq.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub dovetail.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d8u55dsm5y1tq.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub dovetail.${Domain}
          Type: AAAA
        # give.prx.org
        - Name: !Sub give.${Domain}
          ResourceRecords:
            - vanity.classy.org.
          TTL: "300"
          Type: CNAME
        # googlecp.prx.org
        - AliasTarget:
            DNSName: d370xbabo7nuyn.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub googlecp.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d370xbabo7nuyn.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub googlecp.${Domain}
          Type: AAAA
        # guidebook.prx.org
        - Name: !Sub guidebook.${Domain}
          ResourceRecords:
            - ghs.googlehosted.com.
          TTL: "3600"
          Type: CNAME
        # help.prx.org
        - Name: !Sub help.${Domain}
          ResourceRecords:
            - prx.zendesk.com.
          TTL: "300"
          Type: CNAME
        # media.prx.org
        - AliasTarget:
            DNSName: dthqzwgikidi.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub media.${Domain}
          Type: A
        - AliasTarget:
            DNSName: dthqzwgikidi.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub media.${Domain}
          Type: AAAA
        # on.prx.org
        - Name: !Sub on.${Domain}
          ResourceRecords:
            - cname.bitly.com.
          TTL: "3600"
          Type: CNAME
        # soundschool.prx.org
        - AliasTarget:
            DNSName: d20ysf8a0wgchs.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub soundschool.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d20ysf8a0wgchs.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub soundschool.${Domain}
          Type: AAAA
        # status.prx.org
        - Name: !Sub status.${Domain}
          ResourceRecords:
            - zlzvfpy9x7fy.stspg-customer.com.
          TTL: "300"
          Type: CNAME
        # survey.prx.org
        - Name: !Sub survey.${Domain}
          ResourceRecords:
            # short.io
            - "52.21.33.16"
            - "52.2.56.64"
          TTL: "3600"
          Type: A
        # surveys.prx.org
        - Name: !Sub surveys.${Domain}
          ResourceRecords:
            # short.io
            - "52.21.33.16"
            - "52.2.56.64"
          TTL: "3600"
          Type: A
        # training.prx.org
        - Name: !Sub training.${Domain}
          ResourceRecords:
            - ext-cust.squarespace.com.
          TTL: "300"
          Type: CNAME
        # transistor.prx.org
        - AliasTarget:
            DNSName: d3nn7rnvuqkyn9.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub transistor.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d3nn7rnvuqkyn9.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub transistor.${Domain}
          Type: AAAA
        # youthradioleaders.prx.org
        - AliasTarget:
            DNSName: d43em5aywokfv.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub youthradioleaders.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d43em5aywokfv.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub youthradioleaders.${Domain}
          Type: AAAA
  TechProduct:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Tech product
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # prx.org
        - AliasTarget:
            DNSName: d1txozk2299k6z.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Ref Domain
          Type: A
        - AliasTarget:
            DNSName: d1txozk2299k6z.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Ref Domain
          Type: AAAA
        # api.prx.org
        - Name: !Sub api.${Domain}
          ResourceRecords:
            - exchange.prx.tech.
          TTL: "300"
          Type: CNAME
        # assets1.prx.org
        - AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets1.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets1.${Domain}
          Type: AAAA
        # assets2.prx.org
        - AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets2.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets2.${Domain}
          Type: AAAA
        # assets.feeder.prx.org
        - AliasTarget:
            DNSName: d33ymdtl70x4dy.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets.feeder.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d33ymdtl70x4dy.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub assets.feeder.${Domain}
          Type: AAAA
        # augury.prx.org
        - Name: !Sub augury.${Domain}
          ResourceRecords:
            - inventory.dovetail.prx.tech.
          TTL: "300"
          Type: CNAME
        # auth.prx.org
        - Name: !Sub auth.${Domain}
          ResourceRecords:
            - !Sub id.${Domain}
          TTL: "300"
          Type: CNAME
        # beta.prx.org
        - AliasTarget:
            DNSName: d2p9vihsjy95d2.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub beta.${Domain}
          Type: A
        - AliasTarget:
            DNSName: d2p9vihsjy95d2.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
          Name: !Sub beta.${Domain}
          Type: AAAA
        # castle.prx.org
        - Name: !Sub castle.${Domain}
          ResourceRecords:
            - castle.prx.tech.
          TTL: "300"
          Type: CNAME
        # cms.prx.org
        - Name: !Sub cms.${Domain}
          ResourceRecords:
            - cms.prx.tech.
          TTL: "300"
          Type: CNAME
        # exchange.prx.org
        - Name: !Sub exchange.${Domain}
          ResourceRecords:
            - exchange.prx.tech.
          TTL: "300"
          Type: CNAME
        # feeder.prx.org
        - Name: !Sub feeder.${Domain}
          ResourceRecords:
            - podcasts.dovetail.prx.tech.
          TTL: "300"
          Type: CNAME
        # hal.prx.org
        - Name: !Sub hal.${Domain}
          ResourceRecords:
            - !Sub cms.${Domain}
          TTL: "3600"
          Type: CNAME
        # id.prx.org
        - Name: !Sub id.${Domain}
          ResourceRecords:
            - id.prx.tech.
          TTL: "300"
          Type: CNAME
        # inventory.dovetail.prx.org
        - Name: !Sub inventory.dovetail.${Domain}
          ResourceRecords:
            - inventory.dovetail.prx.tech.
          TTL: "300"
          Type: CNAME
        # loadingdock.prx.org
        - Name: !Sub loadingdock.${Domain}
          ResourceRecords:
            - loadingdock.prx.tech.
          TTL: "3600"
          Type: CNAME
        # metrics.prx.org
        - Name: !Sub metrics.${Domain}
          ResourceRecords:
            - metrics.dovetail.prx.tech.
          TTL: "900"
          Type: CNAME
        # metrics.dovetail.prx.org
        - Name: !Sub metrics.dovetail.${Domain}
          ResourceRecords:
            - metrics.dovetail.prx.tech.
          TTL: "900"
          Type: CNAME
        # networks.prx.org
        - Name: !Sub networks.${Domain}
          ResourceRecords:
            - networks.prx.tech.
          TTL: "300"
          Type: CNAME
        # play.prx.org
        - Name: !Sub play.${Domain}
          ResourceRecords:
            - play.prx.tech.
          TTL: "900"
          Type: CNAME
        # podcasts.dovetail.prx.org
        - Name: !Sub podcasts.dovetail.${Domain}
          ResourceRecords:
            - podcasts.dovetail.prx.tech.
          TTL: "900"
          Type: CNAME
        # publish.prx.org
        - Name: !Sub publish.${Domain}
          ResourceRecords:
            - publish.prx.tech.
          TTL: "900"
          Type: CNAME
        # thecastle.prx.org
        - Name: !Sub thecastle.${Domain}
          ResourceRecords:
            - thecastle.prx.tech.
          TTL: "900"
          Type: CNAME
        # thecount.prx.org
        - Name: !Sub thecount.${Domain}
          ResourceRecords:
            - thecount.prx.tech.
          TTL: "900"
          Type: CNAME
        # wfmt.prx.org
        - Name: !Sub wfmt.${Domain}
          ResourceRecords:
            - wfmt.prx.tech.
          TTL: "900"
          Type: CNAME
        # www.prx.org
        - Name: !Sub www.${Domain}
          ResourceRecords:
            # - proxy.prx.tech.
            - d1txozk2299k6z.cloudfront.net.
          TTL: "300"
          Type: CNAME
  Localhost:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Localhost
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub localhost.${Domain}
          ResourceRecords:
            - "127.0.0.1"
          TTL: "3600"
          Type: A
  Offices:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Offices
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub cambridge.${Domain}
          ResourceRecords:
            - "74.94.129.158"
          TTL: "3600"
          Type: A
  Prss:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Legacy PRSS end point
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub prss.${Domain}
          ResourceRecords:
            - "205.153.38.233"
          TTL: "300"
          Type: A

  # Service-specific
  ZenDesk:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: ZenDesk
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # Domain Validation
        - Name: !Sub zendeskverification.${Domain}
          ResourceRecords:
            - '"188d4e7db379ae5f"'
          TTL: "300"
          Type: TXT
        - Name: !Sub zendesk_verification.${Domain}
          ResourceRecords:
            - '"884ea8a417ab496f"'
          TTL: "300"
          Type: TXT
        - Name: !Sub zendesk1.${Domain}
          ResourceRecords:
            - mail1.zendesk.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub zendesk2.${Domain}
          ResourceRecords:
            - mail2.zendesk.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub zendesk3.${Domain}
          ResourceRecords:
            - mail3.zendesk.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub zendesk4.${Domain}
          ResourceRecords:
            - mail4.zendesk.com.
          TTL: "3600"
          Type: CNAME
        # DKIM
        - Name: !Sub zendesk1._domainkey.${Domain}
          ResourceRecords:
            - zendesk1._domainkey.zendesk.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub zendesk2._domainkey.${Domain}
          ResourceRecords:
            - zendesk2._domainkey.zendesk.com.
          TTL: "3600"
          Type: CNAME
  AmazonSes:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: SES DKIM
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # prx-legacy ###########################################################
        ### us-east-1
        ###### DKIM
        - Name: !Sub gzyw7nc2rjfy5u6qplqkbbfuv4tdg5mc._domainkey.${Domain}
          ResourceRecords:
            - gzyw7nc2rjfy5u6qplqkbbfuv4tdg5mc.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub yqwoyh6wt54oqnyelxkn5hdaxkk52kv6._domainkey.${Domain}
          ResourceRecords:
            - yqwoyh6wt54oqnyelxkn5hdaxkk52kv6.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub dqoamfgwjnqyjzoe2rrvwkluoh7ee46v._domainkey.${Domain}
          ResourceRecords:
            - dqoamfgwjnqyjzoe2rrvwkluoh7ee46v.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
          ###### SPF domain aligment
        - Name: !Sub feedback-smtp-us-east-1-amazonses.${Domain}
          ResourceRecords:
            - "10 feedback-smtp.us-east-1.amazonses.com."
          TTL: "3600"
          Type: MX
        - Name: !Sub feedback-smtp-us-east-1-amazonses.${Domain}
          ResourceRecords:
            - '"v=spf1 include:amazonses.com -all"'
          TTL: "3600"
          Type: TXT

        ### us-east-2
        ###### DKIM
        - Name: !Sub svlonliztxvezxut2rdyvbyvymdelrmn._domainkey.${Domain}
          ResourceRecords:
            - svlonliztxvezxut2rdyvbyvymdelrmn.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub kyaduqmjw3d4ra7znaxeobp64gxtojss._domainkey.${Domain}
          ResourceRecords:
            - kyaduqmjw3d4ra7znaxeobp64gxtojss.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub x5r32gdlog7k3b4g5hpb2m6aeqemznt3._domainkey.${Domain}
          ResourceRecords:
            - x5r32gdlog7k3b4g5hpb2m6aeqemznt3.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        ###### SPF domain aligment
        - Name: !Sub feedback-smtp-us-east-2-amazonses.${Domain}
          ResourceRecords:
            - "10 feedback-smtp.us-east-2.amazonses.com."
          TTL: "3600"
          Type: MX
        - Name: !Sub feedback-smtp-us-east-2-amazonses.${Domain}
          ResourceRecords:
            - '"v=spf1 include:amazonses.com -all"'
          TTL: "3600"
          Type: TXT

        ### us-west-2
        ###### DKIM
        - Name: !Sub xu5fuikkoqczc37qnypztreuciznlxlj._domainkey.${Domain}
          ResourceRecords:
            - xu5fuikkoqczc37qnypztreuciznlxlj.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub 7cdvqh6qizmzzc4cuft2zazdzpyuzpui._domainkey.${Domain}
          ResourceRecords:
            - 7cdvqh6qizmzzc4cuft2zazdzpyuzpui.dkim.amazonses.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub zbbjsux5mc2d7ihglk5hcnsz7q3tiuv7._domainkey.${Domain}
          ResourceRecords:
            - zbbjsux5mc2d7ihglk5hcnsz7q3tiuv7.dkim.amazonses.com.
          TTL: "1800"
          Type: CNAME
          ###### SPF domain aligment
        - Name: !Sub feedback-smtp-us-west-2-amazonses.${Domain}
          ResourceRecords:
            - "10 feedback-smtp.us-west-2.amazonses.com."
          TTL: "3600"
          Type: MX
        - Name: !Sub feedback-smtp-us-west-2-amazonses.${Domain}
          ResourceRecords:
            - '"v=spf1 include:amazonses.com -all"'
          TTL: "3600"
          Type: TXT
  AwsAcmLegacyUsEast1:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: AWS ACM validation records for prx-legacy in us-east-1
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # prx.org
        - Name: !Sub _81a7e2b5cf0c4f79d7188da0f03ae72d.${Domain}
          ResourceRecords:
            - _3be53bb29ca3174c2bf7d3af1ba8138d.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # assets.prx.org
        - Name: !Sub _32d33e14d4cd8184f3bc20cb3a7196f8.assets.${Domain}
          ResourceRecords:
            - _dd2283fe6b42a7526f7b9739e0638906.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # assets1.prx.org
        - Name: !Sub _4e92e0c7ba90a9161b249e971d78bb34.assets1.${Domain}
          ResourceRecords:
            - _60dffc2d9ad10247fa937a2c9363a8dc.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # assets2.prx.org
        - Name: !Sub _9664e08413d050d9ce94ac5e7ba8d11c.assets2.${Domain}
          ResourceRecords:
            - _dd8fc717a9e1812a20ca609d2673b50e.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # assets.feeder.prx.org
        - Name: !Sub _b4dfcd47358bf506da3c3800733d4338.assets.feeder.${Domain}
          ResourceRecords:
            - _02342742bb7e9fe0c48977cb0dde2529.jdyyptrhmw.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # beta.prx.org
        - Name: !Sub _13508a876b64465c58be4bfe738438d3.beta.${Domain}
          ResourceRecords:
            - _e829af98d504966c824f814e5235d3f8.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # catapult.prx.org
        - Name: !Sub _4ccd9d98904089a87493a6036ea14417.catapult.${Domain}
          ResourceRecords:
            - _4a6b0a1080a7224d7f854c4e1873415c.yyqgzzsvtj.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # cdn.allusionist.prx.org
        - Name: !Sub _ed818192c01d69685019f0df4a93b99d.cdn.allusionist.${Domain}
          ResourceRecords:
            - _b723750b6c4dd2b56d92bec85cbf575e.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # cdn-allusionist.prx.org
        - Name: !Sub _d5d3126a9ebf5763eeabec3b0c91cf7f.cdn-allusionist.${Domain}
          ResourceRecords:
            - _bcd204f81f26c5e2d4644e2a799e8965.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # cdn.reveal.prx.org
        - Name: !Sub _49790bcba62376a77d03ff169fde946a.cdn.reveal.${Domain}
          ResourceRecords:
            - _ec7e44da2ad2e5f0def8682144d83c6d.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # cdn-reveal.prx.org
        - Name: !Sub _ad9004a66622eb27bec8d010561361ea.cdn-reveal.${Domain}
          ResourceRecords:
            - _6422d90655dea26fb64242eec0459ede.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # dovetail.prx.org
        - Name: !Sub _46bf7d39c705377e6ebc6cdbb68666f7.dovetail.${Domain}
          ResourceRecords:
            - _4cbdcf86962e70574094e66904a1f8c8.gmyctcqpsg.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # feeder.prx.org
        - Name: !Sub _16d5396a2320cf95e39991f091461469.feeder.${Domain}
          ResourceRecords:
            - _22643ddfaf18052fb2db89f0e05cc559.zjfbrrwmzc.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # googlecp.prx.org
        - Name: !Sub _46ef8beed364d392a2f9a1b78ca7cf38.googlecp.${Domain}
          ResourceRecords:
            - _4dcc75601c7d647e3e8b5a87de7a5156.yyqgzzsvtj.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # media.prx.org
        - Name: !Sub _a544dad876ab54f2e7cd244158b65ea7.media.${Domain}
          ResourceRecords:
            - _4ce52ca1a07e39ab0c68b5d2ac294210.ltfvzjuylp.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # play.prx.org
        - Name: !Sub _8d09676a833865f3cf06c51a75ead3e6.play.${Domain}
          ResourceRecords:
            - _0902f8141c71ef447fee9033925c4428.hkmpvcwbzw.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # proxy.prx.org
        - Name: !Sub _f3668666f8f3d4e418cd356d3b9a2b24.proxy.${Domain}
          ResourceRecords:
            - _2b3bfdcd1d1cc385a835e1817c9d85e9.nhqijqilxf.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # soundschool.prx.org
        - Name: !Sub _87977a40d33f2a98b8d35cb66ae6db24.soundschool.${Domain}
          ResourceRecords:
            - _b18f79a775e90f2ada5ed28ace6f14a1.yyqgzzsvtj.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # staging.prx.org
        - Name: !Sub _c734a125558ad81f4bddc3bf33a25a24.staging.${Domain}
          ResourceRecords:
            - _a8bee31e51e6de781121aed08bcbf4d1.hkmpvcwbzw.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # thecount.prx.org
        - Name: !Sub _6663d6d70dd61b92cc497196dcb5fe23.thecount.${Domain}
          ResourceRecords:
            - _3d4ab19090605e892a81fbcbe75021f3.bxmgrlxjqk.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # www.prx.org
        - Name: !Sub _77f825fef8e66773824cae9664b30f4b.www.${Domain}
          ResourceRecords:
            - _02d6b548b20de21df506dda97d2d93cf.nhqijqilxf.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
        # youthradioleaders.prx.org
        - Name: !Sub _9784f5f1de33eb78c3db79157146f598.youthradioleaders.${Domain}
          ResourceRecords:
            - _78f937ab800800d5b4e66192d62246d9.auiqqraehs.acm-validations.aws.
          TTL: "3600"
          Type: CNAME
  CampaignMonitor:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Campaign Monitor
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # DKIM
        # This is the public key matching a private key that Campaign Monitor
        # uses to sign emails it sends on our behalf
        # https://prx.createsend.com/admin/client/domainrecords/F4794DDC869E942D
        - Name: !Sub cm._domainkey.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDGekjRBpJt4pFq65ZNr8SV8+XPiZ+hjkkBToUAeEqGoZCyXFKVDfCEWbdPnp9W8VGf0o5ZBay5z4sGkkhUSGyCBlp8CvCFw7PQqjb9HfC+PrVVQgIRxMyh0Ea6FvMISPADBHj8mSYS+G6E1CMvXm76OaTIruo3/VRUfHhnTR4lnQIDAQAB"'
          TTL: "300"
          Type: TXT
        # SPF domain alignment
        - Name: !Sub cm-bounce.${Domain}
          ResourceRecords:
            - '"v=spf1 include:_spf.createsend.com -all"'
          TTL: "3600"
          Type: TXT
        - Name: !Sub cm-bounce.${Domain}
          ResourceRecords:
            - 5 mx20.inbound.createsend.com
            - 5 mx21.inbound.createsend.com
          TTL: "3600"
          Type: MX
  GitHub:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: GitHub
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub _github-challenge-PRX.${Domain}
          ResourceRecords:
            - '"72a959b7c3"'
          TTL: "300"
          Type: TXT
        - Name: !Sub _github-challenge-PRX.www.${Domain}
          ResourceRecords:
            - '"345d72b442"'
          TTL: "300"
          Type: TXT
  Statuspage:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Statuspage
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub spg._domainkey.notifications.${Domain}
          ResourceRecords:
            - spg.domainkey.u1834393.wl144.sendgrid.net.
          TTL: "300"
          Type: CNAME
        - Name: !Sub spg2._domainkey.notifications.${Domain}
          ResourceRecords:
            - spg2.domainkey.u1834393.wl144.sendgrid.net.
          TTL: "300"
          Type: CNAME
        - Name: !Sub statuspage-notifications.notifications.${Domain}
          ResourceRecords:
            - u1834393.wl144.sendgrid.net.
          TTL: "300"
          Type: CNAME
  Squarespace:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Squarespace
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub h4g4kwd8yd3nhbxj4a5z.${Domain}
          ResourceRecords:
            - verify.squarespace.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub tydshd7bc7mddya37xk3.${Domain}
          ResourceRecords:
            - verify.squarespace.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub 4a4scdp8wg8t76rfa22j.${Domain}
          ResourceRecords:
            - verify.squarespace.com.
          TTL: "3600"
          Type: CNAME
        # training.prx.org
        - Name: !Sub j8sbezddf8w7rtshpbdx.${Domain}
          ResourceRecords:
            - verify.squarespace.com.
          TTL: "3600"
          Type: CNAME
  GoogleWorkspace:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Google Workspace
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # DKIM
        # This is the public key matching a private key that Google Workspace
        # uses to sign emails it send on our behalf
        # https://admin.google.com/ac/apps/gmail/authenticateemail
        - Name: !Sub google._domainkey.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgCwJTbGkQHj1VGKLaSkBhjE/cSzI7zJrIhKC4zGLdj9/5FhhhbbK/8RDcxrFq76b6jFpwoMXL2MRL/+krbyJ1acYmpnghf6ZHum4MFvAovIDHsXk3VQt0nfO/+IsNGkI9WCHB0w4rXzmw5T66I1lHfyGSjET+24sdRW49EdlrbRXlbn+GaKZLmn3Ys7sQgsyK" "vqDbREohNI5KLi9zXg2CEcDCGcrdabacdJoR3/IZM5itgRgCvXxpeVhYXAUxb4BlThF5hp1O9+Dm3LResgO13rkDy475d8HwumKYB52emYFpKOONPAzxL/cbshb+jBJhIymX0wbLzeDDRr2m8puTwIDAQAB"'
          TTL: "300"
          Type: TXT
  SendGrid:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Google Workspace
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub smtpapi._domainkey.${Domain}
          ResourceRecords:
            - '"v=DKIM1; k=rsa; t=s; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDPtW5iwpXVPiH5FzJ7Nrl8USzuY9zqqzjE0D1r04xDN6qwziDnmgcFNNfMewVKN2D1O+2J9N14hRprzByFwfQW76yojh54Xu3uSbQ3JP0A7k8o8GutRF8zbFUA8n0ZH2y0cIEjMliXY4W4LwPA7m4q0ObmvSjhd63O9d8z1XkUBwIDAQAB"'
          TTL: "300"
          Type: TXT
  GoogleCloud:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Google Cloud
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub lihvrd6fmhem.metrics.${Domain}
          ResourceRecords:
            - gv-6ejzc4qvwiyxn7.dv.googlehosted.com.
          TTL: "86400"
          Type: CNAME
  Salesforce:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Salesforce
      HostedZoneId: !Ref HostedZone
      RecordSets:
        # DKIM
        # This is the public key matching a private key that Salesforce
        # uses to sign emails it sends on our behalf
        - Name: !Sub salesforce._domainkey.${Domain}
          ResourceRecords:
            - salesforce.gaj3o5.custdkim.salesforce.com.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub salesforce2._domainkey.${Domain}
          ResourceRecords:
            - salesforce2.mg33er.custdkim.salesforce.com.
          TTL: "3600"
          Type: CNAME
  Bimi:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: BIMI
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub default._bimi.${Domain}
          ResourceRecords:
            - '"v=BIMI1; l=https://media.prx.org/brand-assets/PRX-BIMI.svg"'
          TTL: "3600"
          Type: TXT
  Cloud4J:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Cloud4J
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Name: !Sub cj-bounce.${Domain}
          ResourceRecords:
            - u34190588.wl089.sendgrid.net.
          TTL: "3600"
          Type: CNAME
        # DKIM
        # This is the public key matching a private key that Cloud4J
        # uses to sign emails it sends on our behalf
        - Name: !Sub c4j._domainkey.${Domain}
          ResourceRecords:
            - c4j.domainkey.u34190588.wl089.sendgrid.net.
          TTL: "3600"
          Type: CNAME
        - Name: !Sub c4j2._domainkey.${Domain}
          ResourceRecords:
            - c4j2.domainkey.u34190588.wl089.sendgrid.net.
          TTL: "3600"
          Type: CNAME

  # Legacy
  LegacyStatic:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Static assets
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - Type: A
          Name: !Sub cdn-exchange.${Domain}
          AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub cdn-exchange.${Domain}
          AliasTarget:
            DNSName: d3qpqdoc1119ok.cloudfront.net
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: A
          Name: !Sub cdn-reveal.${Domain}
          AliasTarget:
            DNSName: d3ojv6bn0r3eph.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub cdn-reveal.${Domain}
          AliasTarget:
            DNSName: d3ojv6bn0r3eph.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: A
          Name: !Sub cdn.reveal.${Domain}
          AliasTarget:
            DNSName: d3ojv6bn0r3eph.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub cdn.reveal.${Domain}
          AliasTarget:
            DNSName: d3ojv6bn0r3eph.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: A
          Name: !Sub cdn-allusionist.${Domain}
          AliasTarget:
            DNSName: d2ay8vht0p7hxt.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub cdn-allusionist.${Domain}
          AliasTarget:
            DNSName: d2ay8vht0p7hxt.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: A
          Name: !Sub cdn.allusionist.${Domain}
          AliasTarget:
            DNSName: d2ay8vht0p7hxt.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub cdn.allusionist.${Domain}
          AliasTarget:
            DNSName: d2ay8vht0p7hxt.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: A
          Name: !Sub themoth.${Domain}
          AliasTarget:
            DNSName: dwa2z82v27lla.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
        - Type: AAAA
          Name: !Sub themoth.${Domain}
          AliasTarget:
            DNSName: dwa2z82v27lla.cloudfront.net.
            HostedZoneId: Z2FDTNDATAQYW2 # Global CloudFront hosted zone ID
  Legacy:
    Type: AWS::Route53::RecordSetGroup
    Properties:
      Comment: Various legacy resources
      HostedZoneId: !Ref HostedZone
      RecordSets:
        - ResourceRecords:
            - s3.amazonaws.com.
          TTL: "300"
          Type: CNAME
          Name: !Sub andrew-s3.${Domain}
        - ResourceRecords:
            - s3.amazonaws.com.
          TTL: "300"
          Type: CNAME
          Name: !Sub files.${Domain}
        - ResourceRecords:
            - s3-website-us-east-1.amazonaws.com.
          TTL: "300"
          Type: CNAME
          Name: !Sub economybeat.${Domain}
        - ResourceRecords:
            - s3-website-us-east-1.amazonaws.com.
          TTL: "300"
          Type: CNAME
          Name: !Sub economystory.${Domain}
