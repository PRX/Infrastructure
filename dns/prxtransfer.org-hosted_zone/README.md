The hosted zone stack optionally creates `CALCULATED` health checks based on several child health checks that can be passed in as parameters. When the parameters are excluded, no health checks are created or associated with DNS resource records.

The parameters are expected to be IDs of other health checks created using `health-checking/template.yml`. Each stack created using this template will create multiple Lambda functions: one for each region where we run production FTP servers. Each Lambda function makes frequent test connections to a single FTP server. If the test connection fails, the Lambda execution results in an error. Each function has a CloudWatch Alarm that is configured to alarm when any errors are detected. There is also a Route 53 Health Check that is associated with each alarm; when the alarm is in the alarm state, the associated health check is considered unhealthy.

These health checks are whose IDs are passed into the hosted zone stack. For each region where production FTP servers are running, there is a single `CALCULATED` health check in the hosted zone stack. Each one aggregates all the connection tester health checks that are testing a given region, to ensure that at least one region can connect to each FTP server.

For example, we may have production FTP servers running in `us-east-1` and `us-west-2`. We may deploy a connection tester stack to `us-east-2`, `ca-central-1`, `eu-north-1`, and `ap-notheast-3`. Each of those four testing regions will contain two Lambda functions: one to test `us-east-1` and one to test `us-west-2`. That's a total of eight connection tester Lambda functions, four for `us-east-1` and four for `us-west-2`. The health check IDs of all eight health checks would be passed into the hosted zone stack. The `CALCULATED` health check for `us-east-1` would list all four `us-east-1`-testing health checks as child health checks (same for `us-west-2`), and would have a `HealthThreshold` of `1`. This means that as long as a connection tester in any region is reporting successful connections to the `us-east-1` server, the hosted zone will consider the `us-east-1` server to be healthy.

The `HealthThreshold` is set to `1`, rather than to the total number of child health checks, to avoid any issues that could arrise from the connection tester Lambda function itself from having operation issues in some region. For example, if Lambda functions in `eu-north-1` start returning errors, the associated health check with become unhealthy, but this doesn't represent any actual issue with the FTP servers. As long as at least one connection tester is able to connect to the FTP server, we can assume that other inbound connections to the server from the internet will be successful.

When there is an actual issue with an FTP server in some region, the connection testers running in all regions checking that server will fail, causing all their health checks to become unhealthy, at which point the `CALCULATED` health check will drop below the threshold of `1`, and the entire region will be considered unhealthy. All DNS records associated with that health check will be removed from the routing policy, and traffic will be redirected towards healthy regions until the health check recovers.

**Note:** These health checks are only created for production servers. The connection testers make FTP connections (not FTPS or SFTP), and we only support the FTP protocol in production.
